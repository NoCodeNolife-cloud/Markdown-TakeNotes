[toc]

TSN是由IEEE 802.1 TSN任务组制定的一系列IEEE 802以太网子标准集，该任务组成立于2012年，由IEEE 802.1 AVB(audio video bridging，音视频桥接）任务组改名而成。AVB工作组致力于解决音频视频数据在==以太网介质上传输时的时延较高、抖动较大、传输不确定等问题==。TSN通过==无缝冗余==等机制扩展了AVB技术的性能，为网络提供有界低时延、低抖动和极低数据丢失率的能力。

时间敏感型网络( time sensitive network，TSN) 是 目前国际产业界正在积极推动的全新工业通信技术。时间敏感型网络允许==周期性与非周期性数据==在同一网络中传输，使得标准以太网具有确定性传输的优势，并通过厂商独立的标准化进程，已成为广泛聚焦的关键技术。

# 实时通信技术的发展

## 总线时代

早在 20 世 纪 70 年 代，随着可编程逻辑控制器 ( programmable logic controller，PLC) 的产生，为了分布 式控制所需的总线也诞生。至今，总线技术已经发展 了近 50 年，各始创公司开发了多种总线，其在介质、信 号电平、校验方式、物理接口、波特率等多个指标方面 都有不同。20 世纪 90 年代，随着竞争的加剧，各公司 在 IEC 争取主导地位，产生了“总线之争”。IEC 因此 产生了多达 18 个总线标准，对访问造成很大障碍。 

## 实时以太网阶段

进入 21 世纪，随着标准以太网成本的下降，总线开始进入基于以太网的实时网络时代。2001 年，贝加莱推出了工业应用的 Ethernet POWEＲLINK; 2003 年， 在 Profibus 基 础 上，Siemens 开 发 了 PＲOFINET， Ｒockwell、ABB 开发了基于 DeviceNet 应用层协议的 Ethernet /IP，Beckhoff 开发了 EtherCAT，Ｒexroth 开发了 基于 SEＲCOS 的 SEＲCOSIII。这些网络均采用了标准以太网介质，即在物理层和数据链路层统一了标准，而在应用层仍然保持原有的应用层，旨在保护用户的软件资产投入。 

## 在智能时代的网络融合需求

2014 年以后，随着工业 4． 0 的提出，工业物联网、 智能制造的需求逐渐变得迫切，对于连接的需求产生 了变化。传统的以太网通常不支持交换机网络( 考虑 到延时，通常采用 HUB 的透传方式) ，其轮询机制( 如 Profinet、POWEＲLINK、Ethernet /IP) 或集束帧技术( 如 EtherCAT、SEＲCOSIII) 使得标准以太网和实时以太网无法在同一网络中进行数据的传输。但是，对于 边缘计算、工业物联网、智能制造的全局优化而言， 制造现场控制所需的实时性数据和生产管理与优化层所需的非实时性数据要通过统一网络进行集中， 在统一的数据平台进行数据处理与分析，并能够下发到各个控制器执行; 而一些全局优化的工作并不需要通过层级的控制器，而是希望直接到边缘侧或者云端。这使得同一网络的需求变得迫切。另外， 对于制造业的终端用户而言，生产系统往往由来自不同企业的设备与系统构成，必须有统一的网络与协议规范。因此，独立于厂商的总线在智能时代变得更为必要。

![image-20210808172829254](TSN.assets/image-20210808172829254.png)

![image-20210808173158187](TSN.assets/image-20210808173158187.png)

# TSN 基本概念

TSN 由一系列技术标准构成。其主要分为时钟同 步、数据流调度策略( 即整形器) 以及 TSN 网络与用户 配置三个部分相关标准

## VLAN 技术

按照网络架构，网络通常分为标准以太网、确定性以太网。TSN 实现了混合网络的数据传输能力，满足标准以太网的分布式对等架构、确定性网络所采用的轮询/集束帧技术各自的存在的要求，并使得网络能够发挥各自的优势功能。TSN 基于 IEEE 802．1Q的虚拟局域网( virtual local area network，VLAN) 和优先级标准。 

IEEE 802． 1Q 支持服务质量( quality of service，QoS) 。 QoS 是一种基础网络技术，用于为网络通信提供更好的 服务。它是一种网络安全机制，用于解决网络延时与拥 塞的问题。最初的 Internet 并未设计 QoS 机制。为满足 用户不同应用的服务质量需求，需要网络能够根据用户 需求进行配置与资源调度。IEEE 802． 1Q 标准是一种 包含了 QoS 机制的网络，能够提供网络性能的可预知 性，并有效分配网络带宽，以便合理利用资源。 

### TSN

TSN 是 IEEE 802． 1Q 标准的 VLAN。该标准在标 准以太网帧中插入 4 个字节用于定义其特征。TSN 的 标签位定义如图 3 所示。 

![image-20210808175513042](TSN.assets/image-20210808175513042.png)

①标签协议识别: 网络类型识别，代表这是一个 TSN网络，标记 0X8100。 

②优先级代码( priority code point，PCP) 由 3 位代码构成。 

③丢弃标志位: 对于网络低 QoS 要求的数据，可以丢弃，以确保高优先级数据的 QoS。 

④VLAN Identifier( VID) : VLAN 网络的识别号，12 位表示可支持的子网数量，2 的 12 次方即 4 096，VID = 0 用于识别帧优先级，4 095 ( FFF) 作为预留值。所以， VID 最多可以表示 4 094 个子网。这表明 TSN 是为了 大型的数据传输而设计的。 

### 优先级的定义

TSN 有一个服务等级( class of service，CoS) 的概念。对 TSN 网络而言，不同优先级的服务对应图 3 中 的 PCP 码。3 位 PCP 码定义了 0( 最低) ～ 7( 最高) 这 8 个优先级，传输类型分别对应基础、最大努力、卓越努力、严苛应用、延时和抖动小于 100 ms 的视频、延时 和抖动小于 10 ms 的音频、内部网络控制、网络控制。 其会对网络场景进行不同的匹配，是后续调度、配置设计中会考虑到的数据流调度因素。 

### TSN 在 ISO/OSI 模型中的位置

![image-20210808182913457](TSN.assets/image-20210808182913457.png)

